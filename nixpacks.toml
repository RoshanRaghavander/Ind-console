[phases.setup]
# Vite 7 requires Node >=20.19 or >=22.12; Dokploy defaulted to Node 18.
nixPkgs = ["nodejs_22", "pnpm-9_x", "openssl"]

[phases.install]
cmds = ["pnpm i --frozen-lockfile"]

# Increase Node heap for Vite build (avoid exit code 134 / OOM)
[phases.build]
cmds = ["NODE_OPTIONS='--max-old-space-size=4096' pnpm run build"]

[start]
cmd = "pnpm run start"
